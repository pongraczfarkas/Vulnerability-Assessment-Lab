# Vulnerability Assessment Lab

## Description
This guide explains how I set up a Virtual Machine environment using VirtualBox with Windows 10. The purpose of this project was to gain experience with Nessus Essentials, learning how to scan for and remediate vulnerabilities. This project highlights two key steps in the Vulnerability Management Lifecycle. Using Nessus Essentials, I will scan local VMs hosted on VirtualBox Workstation to conduct credentialed scans, identify vulnerabilities, remediate some of them, and then perform a rescan to verify the remediation.

## Utilities used
- Nessus Essentials
- CMD

## Environments used
- Oracle VM VirtualBox
- Windows 10 (22H2)

## Links
- Windows 10: [Download](https://www.microsoft.com/en-us/software-download/windows10)
- Oracle VM VirtualBox: [Download](https://www.virtualbox.org/)
- Nessus Essentials: [Download](https://www.tenable.com/products/nessus/nessus-essentials?action=register)

## Walkthrough
After installing my VM, where I will manage vulnerabilities, I need to configure the network adapter to be host-only so it can be on the same network as my host machine. This setup is necessary because Nessus needs to perform a Secure Server Login (SSL) into the Virtual Machine, and it's more straightforward if it's using my local network.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/644c3115-9f2d-4c51-901c-d488871e4e2b">
</p>

I downloaded Nessus Essentials, my vulnerability management software. Since this download takes a considerable amount of time, I can multitask by also configuring Windows 10 on the Virtual Machine, which is another lengthy process.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/930a63e8-8eca-4c47-9baf-1f4c1454bb98">
</p>

I knew from previous experience that incoming ping will not work from another machine, so I turned off the Windows Defender Firewall.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/3560c575-8ba1-4522-b1cd-aec91677b6b7">
</p>

Then I gathered the IP address of the VM to figure out the IP address to use later with Nessus.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/5bd73dd9-3549-46cc-ae29-b934a84a1252">
</p>

I attempt to ping the VM from my host computer to check if communication is possible. This step is crucial because if I can't ping the VM, Nessus won't be able to either, preventing it from running scans.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/88d5fd1a-2d34-4424-a0a3-36cc4e0749a0">
</p>

After Nessus Essentials compiled I created a new Basic Network Scan.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/a9f74782-1c7e-452f-bd32-ac5014ee3ceb">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/ea83f056-32ae-4d8d-89ae-8fdd9b19299b">
</p>

I gave a name to my new scan, supplied the VM's IP address to it and launched the scan.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/0ae072d4-bdc4-42fe-a85c-30dcbb1569b1">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/a8042d22-a29b-4a13-b10b-29778d38fb86">
</p>

Let's examine the results! We have 31 findings: 29 informational, 1 low, and 1 medium. In a production environment, these would likely be left unaddressed. The informational results are probably due to some items lacking proper credentials and are not actual vulnerabilities.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/840bb360-a56d-4956-a397-16d644d6d03c">
</p>

Examining one of the informational results, we see that the "Target Credential Status By Authentication Protocol" was triggered because no credentials were provided for this scan.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/196aa659-b46b-492a-9589-db7152bf6d21">
</p>

Next, I configure the VM to accept authenticated scans and provide credentials to Nessus. Afterward, I will rescan the VM and compare the results. To start this process, I navigate to services.msc and enable Remote Registry. Enabling Remote Registry allows Nessus to connect to the VM's registry and conduct thorough scans for vulnerabilities such as insecure connections or deprecated cipher suites. I'm following these steps based on Nessus recommendations for conducting credentialed scans, though there might be alternative methods available.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/6f6e42cc-d1e4-407e-9b49-6e2ee25ce2a8">
</p>

Then, I proceed to disable User Account Control (UAC). This step is necessary because the VM is not joined to a domain, requiring unconventional methods to ensure proper functionality. It's important to note that such actions are solely for experimental purposes and would not be employed in a professional or production environment.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/429e1fb8-266b-4b12-a1ab-c587267ae96c">
</p>

Next, I will access the registry and create a key intended to further disable User Account Control, enabling Nessus to establish connections as needed.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/eb65877a-68cb-48d4-a71d-a22d2040b10b">
</p>

With the registry settings adjusted I restarted the VM. Then I return to Nessus to configure the scan I set up earlier. I need to include the credentials—specifically, the username, password and domain of the VM—to ensure the scan operates correctly. These credentials enable Nessus to access necessary areas within the VM's registry. Then I performed a scan again.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/9cd41869-3e3b-46e2-94f0-7bc59486899d">
</p>

This new scan has identified significantly more vulnerabilities compared to the initial scan, thanks to its ability to conduct deeper scans within the VM with proper credentials.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/4c763029-91b0-40f2-8146-16fde2fe8f71">
</p>

I'm curious to test the capabilities of this Nessus Scanner, so I'm going to download a very old version of some software, which likely has numerous vulnerabilities, to see if Nessus can detect them (I'm confident it will).

Links to the software I used:
- Google Chrome: [Download](https://www.slimjet.com/chrome/download-chrome.php?file=win%2Fchrome32_68.0.3440.84.exe)
- Minecraft Server: [Download](https://mcversions.net/download/1.18.1)
- 7-Zip: [Download](https://7-zip.en.uptodown.com/windows/download/2157309)

After I downloaded the software, installed Chrome, 7-Zip and unpacked the Minecraft Server. I purposely turned off Google Chrome Updates from the System Configuration so it doesn't update to the newest version and I can showcase the sweet alerts.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/b417b5f9-f93c-4b6a-9b10-518c5bbe83b9">
</p>

Then I ran another scan.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/8821762f-b33e-479a-ae52-631485f80063">
</p>

Looking at the vulnerabilities it can be seen, that we have for example Apache Log4J vulnerabilities from the Minecraft Server. It is amazing that Nessus can detect it from just the unpacked .jar file.

<p align="center">
  <img src="https://github.com/pongraczfarkas/Vulnerability-Assessment-Lab/assets/61662033/33d1c610-a90c-43e3-a4b7-6b31efe8f">
</p>
